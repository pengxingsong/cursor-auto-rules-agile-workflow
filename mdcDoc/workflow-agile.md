# 敏捷工作流

**关键规则**：首先确保存在 .ai/prd.md 文件，如果没有，与用户一起创建一个，以便您了解项目的内容。

**关键规则**：此工作流对您的记忆系统至关重要，所有计划的内容或已完成或更改的内容都将记录在 .ai 文件夹中。保持此信息的高质量并保持更新至关重要。当您不确定时，根据需要参考 PRD、ARCH、当前和以前的故事以指导您的决策。

## 工作流步骤

1. 当上线时，您将首先检查是否存在 .ai/prd.md 文件，如果没有，与用户一起创建一个，以便您了解项目的内容。

2. 根据需要帮助改进 .ai/prd.md 文件（如果未标记为已批准），以确保它是最佳的文档，包括以下内容：
   - 非常详细的目的、解决的问题和任务序列
   - 非常详细的架构模式和关键技术决策，使用 mermaid 图表帮助可视化架构
   - 非常详细的技术、设置和约束
   - 未知数、假设和风险

3. 一旦创建了 .ai/prd.md 文件并且状态为已批准，生成架构文档 .ai/arch.md 草稿 - 这也需要被批准。

4. 一旦 .ai/arch.md 被批准，在 .ai 文件夹中创建第一个故事的草稿。

5. 始终使用 @903-story.mdc.mdc 文件作为故事的模板。故事将被命名为 `<story-or-task-><N>.story.md` 并添加到 .ai 文件夹
   - 示例：.ai/story-1.story.md 或 .ai/task-1.story.md

- 由于我们遵循 TDD，故事中的每个子任务都将包括至少 80% 质量覆盖率的单元测试。

5. 您将等待故事的批准，然后再继续处理故事。

6. 您是 TDD 大师，因此您将运行测试并确保测试通过，然后再进行下一个子任务或故事。

7. 您将在子任务完成时更新故事文件。

8. 一旦故事完成，您将生成下一个故事的草稿并等待批准再继续。

## 开发期间

- 在子任务完成时更新故事文件
- 如果您不确定下一步，请向用户询问澄清
- 当用户提示"更新故事"时，更新当前故事以：
  - 反映当前状态
  - 澄清下一步
- 继续验证故事是否正确，下一步是否清晰

## 您无需询问即可：

1. 如果不存在下一个要处理的故事文件，则创建它
2. 在开发过程中运行单元测试直到通过
3. 在完成任务时更新故事 AC 和任务
4. 使用聊天日志或其他更新来更新故事文件，以保留故事的最佳记忆